!function(){"use strict";function e(e){var t={login:function(t){return e.post(o+"login",t)},logOut:function(){return e.get(o+"logout")},getStudent:function(){return e.get(o+"user").then(function(e){return e.data})["catch"](function(e){console.log(e)})},getSeminar:function(){return e.get(o+"student/seminar").then(function(e){return e.data})["catch"](function(e){console.log(e)})}};return t}function t(e){var t={getCurrentStudent:function(){return e.get(o+"studentinfo").then(function(e){return e.data})["catch"](i)},getCompany:function(){return e.get(o+"company").then(function(e){return e.data})["catch"](i)},getCompanyOtherInfo:function(){return e.get(o+"company/otherinfo").then(function(e){return e.data})["catch"](i)},getCompanyFutureProjectionCalculator:function(t){return e.get(o+"future_projection_calculator/"+t).then(function(e){return e.data})["catch"](i)},getCompanyProductPortfolio:function(){return e.get(o+"product_portfolio").then(function(e){return e.data})["catch"](i)},getCompanySpendingDetails:function(){return e.get(o+"spending_details").then(function(e){return e.data})["catch"](i)},addSku:function(t){return e.post(o+"sku/decision/",t)},updateSku:function(t){return e.put(o+"sku/decision/",t)},delSku:function(t,n){return e["delete"](o+"sku/decision/"+n+"/"+t)},addBrand:function(t){return e.post(o+"brand/decision/",t)},updateBrand:function(t){return e.put(o+"brand/decision",t)},updateCompany:function(t){return e.put(o+"company/decision",t)},getFinalScore:function(t){return e.get(o+"finalscore/"+t).then(function(e){e.data.highest_score=_.max(e.data.scores,function(e){return e.finalScore}).finalScore;for(var t=0;t<e.data.scores.length;t++)e.data.scores[t].companyName=String.fromCharCode(64+e.data.scores[t].companyId);return e.data})["catch"](i)},getQuestionnaire:function(){return e.get(o+"questionnaire")},updateQuestionnaire:function(t){return e.put(o+"questionnaire",t)}};return t}function n(e,t,n){function r(e){var t={0:function(){return s.ReportInventoryReportLabelFreshInventory},1:function(){return s.ReportInventoryReportLabelPreviousInventory},2:function(){return s.ReportInventoryReportLabelCloseToExpireInventory}};return"function"!=typeof t[e]?!1:t[e]()}function a(e){var t={A:function(){return s.HomePageSecondMenuBarLabelsCompany+"A"},B:function(){return s.HomePageSecondMenuBarLabelsCompany+"B"},C:function(){return s.HomePageSecondMenuBarLabelsCompany+"C"},D:function(){return s.HomePageSecondMenuBarLabelsCompany+"D"},E:function(){return s.HomePageSecondMenuBarLabelsCompany+"E"},F:function(){return s.HomePageSecondMenuBarLabelsCompany+"F"}};return"function"!=typeof t[e]?!1:t[e]()}function u(e){var t={0:function(){return s.HomePageSegmentLabelPriceSensitive},1:function(){return s.HomePageSegmentLabelPretenders},2:function(){return s.HomePageSegmentLabelModerate},3:function(){return s.HomePageSegmentLabelGoodLife},4:function(){return s.HomePageSegmentLabelUltimate},5:function(){return s.HomePageSegmentLabelPragmatic},6:function(){return s.HomePageSegmentLabelAllSegments},priceSensitive:function(){return s.HomePageSegmentLabelPriceSensitive},pretenders:function(){return s.HomePageSegmentLabelPretenders},moderate:function(){return s.HomePageSegmentLabelModerate},goodLife:function(){return s.HomePageSegmentLabelGoodLife},ultimate:function(){return s.HomePageSegmentLabelUltimate},pragmatic:function(){return s.HomePageSegmentLabelPragmatic},allSegments:function(){return s.HomePageSegmentLabelAllSegments}};return"function"!=typeof t[e]?!1:t[e]()}function c(){return s.ReportPerceptionMapAxisLabelSegment}var s={ReportInventoryReportLabelCloseToExpireInventory:"",ReportInventoryReportLabelPreviousInventory:"",ReportInventoryReportLabelFreshInventory:"",HomePageSecondMenuBarLabelsCompany:"",HomePageSegmentLabelPriceSensitive:"",HomePageSegmentLabelPretenders:"",HomePageSegmentLabelModerate:"",HomePageSegmentLabelGoodLife:"",HomePageSegmentLabelUltimate:"",HomePageSegmentLabelPragmatic:"",HomePageSegmentLabelAllSegments:""},l={series:[],data:[]},m={title:"",tooltips:!0,labels:!1,legend:{display:!0,position:"right"},innerRadius:0,lineLegend:"traditional",lineCurveType:"monotone"},d={title:"",tooltips:!0,labels:!1,legend:{display:!1,position:"right"},innerRadius:0,lineLegend:"traditional",lineCurveType:"linear"},g={title:"",tooltips:!0,labels:!1,legend:{display:!0,position:"right"},innerRadius:0,lineLegend:"traditional",lineCurveType:"linear"},h=function(e,t){return l.series=[],l.data=[],angular.isUndefined(e.periods)?(angular.forEach(e.chartData,function(e){angular.isUndefined(e.segmentName)?-1==l.series.indexOf(e.SKUName.substring(0,1))&&l.series.push(e.SKUName.substring(0,1)):l.series.push(u(e.segmentName))}),angular.forEach(e.chartData,function(e){var n={x:0,y:[]};if(angular.isUndefined(e.segmentName)){n.x=e.SKUName;var r=l.series.indexOf(e.SKUName.substring(0,1));if(-1!==r)for(var a=0;r>=a;a++)n.y.push(a==r?0===t?Math.round(100*e.valueSegmentShare)/100:Math.round(1e4*e.valueSegmentShare)/Math.pow(10,Number(t)):0)}else n.x=u(e.segmentName),n.y.push(0===t?Math.round(100*e.value)/100:Math.round(1e4*e.value)/Math.pow(10,Number(t)));l.data.push(n)}),angular.copy(l)):angular.isArray(e.periods)?(angular.forEach(e.periods,function(n,r){var a={x:n.toString(),y:angular.copy(e.chartData[r])};angular.forEach(a.y,function(e,n){a.y[n]=0===t?Math.round(100*e)/100:Math.round(1e4*e)/Math.pow(10,Number(t))}),l.data.push(a)}),angular.isUndefined(e.companyNames)?angular.forEach(e.segmentNames,function(e){l.series.push(u(e))}):angular.forEach(e.companyNames,function(e){l.series.push(a(e))}),angular.copy(l)):(console.log("chart Data format is wrong !"),"")},f=function(e,t){function n(e){var t=["rgb(0,76,229)","rgb(187,0,0)","rgb(255,188,1)","rgb(51,153,51)","rgb(153,0,153)","rgb(255,82,0)"],n={A:function(){return t[0]},B:function(){return t[1]},C:function(){return t[2]},D:function(){return t[3]},E:function(){return t[4]},F:function(){return t[5]}};return"function"!=typeof n[e]?!1:n[e]()}return l.series=["justoneseries"],l.data=[],angular.isUndefined(e.periods)&&angular.forEach(e.chartData,function(e){var r={x:"",y:[],color:"rgb(57,181,74)"};angular.isUndefined(e.segmentName)&&(r.x=e.SKUName,r.y.push(0===t?Math.round(100*e.valueSegmentShare)/100:Math.round(1e4*e.valueSegmentShare)/Math.pow(10,Number(t))),r.color=n(e.SKUName.substring(0,1))),l.data.push(r)}),angular.copy(l)},p=function(e){return l.series=[],l.data=[],angular.isUndefined(e[0].data)?(angular.forEach(e[0],function(e,t){"period"!==t&&"$$hashKey"!==t&&l.series.push(u(t))}),angular.forEach(e,function(e){var t={x:0,y:[]};t.x=e.period,angular.forEach(e,function(e,n){"period"!==n&&"$$hashKey"!==n&&t.y.push(Math.round(1e4*e)/1e4)}),l.data.push(t)})):(angular.forEach(e[0].data,function(e){var t={x:0,y:[]};t.x=e.name,l.data.push(t)}),angular.forEach(e,function(e){angular.isUndefined(e.SKUName)||l.series.push(e.SKUName),angular.isUndefined(e.brandName)||l.series.push(e.brandName),angular.isUndefined(e.companyName)||l.series.push(a(e.companyName)),angular.forEach(e.data,function(e,t){l.data[t].y.push(Math.round(100*e.value)/100)})})),angular.copy(l)},y=function(e){return l.series=[],l.data=[],angular.isArray(e.SKUs)?(angular.forEach(e.SKUs[0].inventoryData,function(e,t){var n={key:r(e.inventoryName),values:[]};0!==t&&(l.data.push(n),l.series.push(r(e.inventoryName)))}),angular.forEach(e.SKUs,function(e){var t=[];t.push(e.SKUName),t.push(angular.copy(Math.round(100*e.inventoryData[1].inventoryValue)/100));var n=[];n.push(e.SKUName),n.push(angular.copy(Math.round(100*e.inventoryData[2].inventoryValue)/100)),l.data[0].values.push(t),l.data[1].values.push(n)}),angular.copy(l.data)):void 0},_=function(e){if(l.dataSKU=[],l.dataBrand=[],l.series=[],l.data=[],angular.isArray(e)){angular.forEach(e,function(e){var t={key:a(e.companyName),values:[]},n={key:a(e.companyName),values:[]};angular.forEach(e.SKUs,function(n){var r={x:Math.round(1e7*n.valuePerception+1e3*Math.random())/1e7,y:Math.round(1e7*n.imagePerception+1e3*Math.random())/1e7,size:.6,SKUName:n.SKUName,name:n.SKUName,CompanyName:e.companyName,tooltips:n.tooltips,shape:"circle"};t.values.push(r)}),angular.forEach(e.brands,function(t){var r={x:Math.round(100*t.valuePerception)/100,y:Math.round(100*t.imagePerception)/100,size:.6,BrandName:t.brandName,name:t.brandName,CompanyName:e.companyName,tooltips:[],shape:"circle"};n.values.push(r)}),l.dataSKU.push(t),l.dataBrand.push(n)});var t={key:c(),values:[]};return angular.forEach(e[0].exogenous,function(e){var n={x:Math.round(100*e.valuePerception)/100,y:Math.round(100*e.imagePerception)/100,size:.5,name:u(e.segmentName),tooltips:[],shape:"diamond"};t.values.push(n)}),l.dataSKU.push(t),l.dataBrand.push(t),angular.copy(l)}},v={getChartConfig1:function(){return angular.copy(m)},getChartConfig2:function(){return angular.copy(d)},getChartConfig3:function(){return angular.copy(g)},formatChartData:function(e){return p(e)},inventoryReport:function(){return n(["ReportInventoryReportLabelCloseToExpireInventory","ReportInventoryReportLabelPreviousInventory","ReportInventoryReportLabelFreshInventory","HomePageSecondMenuBarLabelsCompany","ReportPerceptionMapAxisLabelSegment","HomePageSegmentLabelPriceSensitive","HomePageSegmentLabelPretenders","HomePageSegmentLabelModerate","HomePageSegmentLabelGoodLife","HomePageSegmentLabelUltimate","HomePageSegmentLabelPragmatic","HomePageSegmentLabelAllSegments"]).then(function(t){return s.ReportInventoryReportLabelCloseToExpireInventory=t.ReportInventoryReportLabelCloseToExpireInventory,s.ReportInventoryReportLabelPreviousInventory=t.ReportInventoryReportLabelPreviousInventory,s.ReportInventoryReportLabelFreshInventory=t.ReportInventoryReportLabelFreshInventory,s.HomePageSecondMenuBarLabelsCompany=t.HomePageSecondMenuBarLabelsCompany,s.ReportPerceptionMapAxisLabelSegment=t.ReportPerceptionMapAxisLabelSegment,s.HomePageSegmentLabelPriceSensitive=t.HomePageSegmentLabelPriceSensitive,s.HomePageSegmentLabelPretenders=t.HomePageSegmentLabelPretenders,s.HomePageSegmentLabelModerate=t.HomePageSegmentLabelModerate,s.HomePageSegmentLabelGoodLife=t.HomePageSegmentLabelGoodLife,s.HomePageSegmentLabelUltimate=t.HomePageSegmentLabelUltimate,s.HomePageSegmentLabelPragmatic=t.HomePageSegmentLabelPragmatic,s.HomePageSegmentLabelAllSegments=t.HomePageSegmentLabelAllSegments,e.get(o+"chart/inventory_report")}).then(function(e){return y(e.data)})["catch"](i)},marketShareInValue:function(){return e.get(o+"chart/market_share_in_value").then(function(e){return h(e.data,2)})["catch"](i)},marketShareInVolume:function(){return e.get(o+"chart/market_share_in_volume").then(function(e){return h(e.data,2)})["catch"](i)},mindSpaceShare:function(){return e.get(o+"chart/mind_space_share").then(function(e){return h(e.data,2)})["catch"](i)},shelfSpaceShare:function(){return e.get(o+"chart/shelf_space_share").then(function(e){return h(e.data,2)})["catch"](i)},totalInvestment:function(){return e.get(o+"chart/total_investment").then(function(e){return h(e.data,0)})["catch"](i)},netProfitByCompanies:function(){return e.get(o+"chart/net_profit_by_companies").then(function(e){return h(e.data,0)})["catch"](i)},returnOnInvestment:function(){return e.get(o+"chart/return_on_investment").then(function(e){return h(e.data,0)})["catch"](i)},investmentsVersusBudget:function(){return e.get(o+"chart/investments_versus_budget").then(function(e){return h(e.data,0)})["catch"](i)},marketSalesValue:function(){return e.get(o+"chart/market_sales_value").then(function(e){return h(e.data,0)})["catch"](i)},marketSalesVolume:function(){return e.get(o+"chart/market_sales_volume").then(function(e){return h(e.data,0)})["catch"](i)},totalInventoryAtFactory:function(){return e.get(o+"chart/total_inventory_at_factory").then(function(e){return h(e.data,0)})["catch"](i)},totalInventoryAtTrade:function(){return e.get(o+"chart/total_inventory_at_trade").then(function(e){return h(e.data,0)})["catch"](i)},segmentsLeadersByValuePriceSensitive:function(){return e.get(o+"chart/segments_leaders_by_value_price_sensitive").then(function(e){return f(e.data,2)})["catch"](i)},segmentsLeadersByValuePretenders:function(){return e.get(o+"chart/segments_leaders_by_value_pretenders").then(function(e){return f(e.data,2)})["catch"](i)},segmentsLeadersByValueModerate:function(){return e.get(o+"chart/segments_leaders_by_value_moderate").then(function(e){return f(e.data,2)})["catch"](i)},segmentsLeadersByValueGoodLife:function(){return e.get(o+"chart/segments_leaders_by_value_good_life").then(function(e){return f(e.data,2)})["catch"](i)},segmentsLeadersByValueUltimate:function(){return e.get(o+"chart/segments_leaders_by_value_ultimate").then(function(e){return f(e.data,2)})["catch"](i)},segmentsLeadersByValuePragmatic:function(){return e.get(o+"chart/segments_leaders_by_value_pragmatic").then(function(e){return f(e.data,2)})["catch"](i)},perceptionMap:function(){return e.get(o+"chart/perception_map").then(function(e){return _(e.data)})["catch"](i)},growthRateInVolume:function(){return e.get(o+"chart/growth_rate_in_volume").then(function(e){return h(e.data,0)})["catch"](i)},growthRateInValue:function(){return e.get(o+"chart/growth_rate_in_value").then(function(e){return h(e.data,0)})["catch"](i)},netMarketPrice:function(){return e.get(o+"chart/net_market_price").then(function(e){return h(e.data,0)})["catch"](i)},segmentValueShareTotalMarket:function(){return e.get(o+"chart/segment_value_share_total_market").then(function(e){return h(e.data,2)})["catch"](i)}};return v}function r(e){var t={companyStatus:function(){return e.get(o+"report/company_status").then(function(e){return e.data})["catch"](i)},financialReport:function(){return e.get(o+"report/financial_report").then(function(e){return e.data})["catch"](i)},profitabilityEvolution:function(){return e.get(o+"report/profitability_evolution").then(function(e){return e.data})["catch"](i)},competitorIntelligence:function(){return e.get(o+"report/competitor_intelligence").then(function(e){return e.data})["catch"](i)},segmentDistribution:function(){return e.get(o+"report/segment_distribution").then(function(e){return e.data})["catch"](i)},marketTrends:function(){return e.get(o+"report/market_trends").then(function(e){return e.data})["catch"](i)},marketIndicators:function(){return e.get(o+"report/market_indicators").then(function(e){return e.data})["catch"](i)}};return t}function a(e){var t={getFAQ:function(){return e.get(o+"faq").then(function(e){return e.data})["catch"](i)},getManualChinese:function(){return e.get("/marksimos/manual/zh_CN").then(function(e){return e.data})["catch"](i)},getManualEnglish:function(){return e.get("/marksimos/manual/en_US").then(function(e){return e.data})["catch"](i)}};return t}angular.module("marksimos.model",["pascalprecht.translate","marksimos.translation"]),angular.module("marksimos.model").factory("Student",["$http",e]),angular.module("marksimos.model").factory("Company",["$http",t]),angular.module("marksimos.model").factory("chartReport",["$http","$rootScope","$translate",n]),angular.module("marksimos.model").factory("tableReport",["$http",r]),angular.module("marksimos.model").factory("Help",["$http",a]);var o="/marksimos/api/",i=function(e){console.log("Error 404 , Type : API ",e)};angular.module("marksimos.model").factory("JSONKit",function(){return window.JSONKit}),angular.module("marksimos.model").factory("pretty",function(){return window.prettyPrint}),angular.module("marksimos.model").factory("isVisible",function(){return function(e){var t=e[0].getBoundingClientRect();return Boolean(t.bottom-t.top)}}),angular.module("marksimos.model").factory("mdParse",["JSONKit",function(e){return function(t){return window.marked(e.toStr(t))}}]),angular.module("marksimos.model").factory("sanitize",["JSONKit",function(e){function t(){var e,n;for(n=arguments[0]||{},this.config={},this.config.elements=n.elements?n.elements:[],this.config.attributes=n.attributes?n.attributes:{},this.config.attributes[t.ALL]=this.config.attributes[t.ALL]?this.config.attributes[t.ALL]:[],this.config.allow_comments=n.allow_comments?n.allow_comments:!1,this.allowed_elements={},this.config.protocols=n.protocols?n.protocols:{},this.config.add_attributes=n.add_attributes?n.add_attributes:{},this.dom=n.dom?n.dom:document,e=0;e<this.config.elements.length;e++)this.allowed_elements[this.config.elements[e]]=!0;if(this.config.remove_element_contents={},this.config.remove_all_contents=!1,n.remove_contents)if(n.remove_contents instanceof Array)for(e=0;e<n.remove_contents.length;e++)this.config.remove_element_contents[n.remove_contents[e]]=!0;else this.config.remove_all_contents=!0;this.transformers=n.transformers?n.transformers:[]}t.REGEX_PROTOCOL=/^([A-Za-z0-9\+\-\.\&\;\*\s]*?)(?:\:|&*0*58|&*x0*3a)/i,t.RELATIVE="__relative__",t.prototype.clean_node=function(e){function n(e,t){var n;for(n=0;n<t.length;n++)if(t[n]==e)return n;return-1}function r(){var e,t,n=[],r={};for(e=0;e<arguments.length;e++)if(arguments[e]&&arguments[e].length)for(t=0;t<arguments[e].length;t++)r[arguments[e][t]]||(r[arguments[e][t]]=!0,n.push(arguments[e][t]));return n}function a(e){var t;switch(e.nodeType){case 1:o.call(u,e);break;case 3:t=e.cloneNode(!1),u.current_element.appendChild(t);break;case 5:t=e.cloneNode(!1),u.current_element.appendChild(t);break;case 8:u.config.allow_comments&&(t=e.cloneNode(!1),u.current_element.appendChild(t));break;default:console&&console.log&&console.log("unknown node type",e.nodeType)}}function o(e){var o,c,s,l,m,d,g,h,f,p,y=i.call(u,e);if(e=y.node,s=e.nodeName.toLowerCase(),c=u.current_element,u.allowed_elements[s]||y.whitelist){u.current_element=u.dom.createElement(e.nodeName),c.appendChild(u.current_element);var _=u.config.attributes;for(l=r(_[s],_.__ALL__,y.attr_whitelist),o=0;o<l.length;o++)d=l[o],m=e.attributes[d],m&&(p=!0,u.config.protocols[s]&&u.config.protocols[s][d]&&(h=u.config.protocols[s][d],f=m.value.toLowerCase().match(t.REGEX_PROTOCOL),p=f?-1!=n(f[1],h):-1!=n(t.RELATIVE,h)),p&&(g=document.createAttribute(d),g.value=m.value,u.current_element.setAttributeNode(g)));if(u.config.add_attributes[s])for(d in u.config.add_attributes[s])g=document.createAttribute(d),g.value=u.config.add_attributes[s][d],u.current_element.setAttributeNode(g)}else if(-1!=n(e,u.whitelist_nodes)){for(u.current_element=e.cloneNode(!0);u.current_element.childNodes.length>0;)u.current_element.removeChild(u.current_element.firstChild);c.appendChild(u.current_element)}if(!u.config.remove_all_contents&&!u.config.remove_element_contents[s])for(o=0;o<e.childNodes.length;o++)a.call(u,e.childNodes[o]);u.current_element.normalize&&u.current_element.normalize(),u.current_element=c}function i(e){var t,a,o,i={attr_whitelist:[],node:e,whitelist:!1};for(t=0;t<u.transformers.length;t++)if(o=u.transformers[t]({allowed_elements:u.allowed_elements,config:u.config,node:e,node_name:e.nodeName.toLowerCase(),whitelist_nodes:u.whitelist_nodes,dom:u.dom}),null!==o){if("object"!=typeof o)throw new Error("transformer output must be an object or null");if(o.whitelist_nodes&&o.whitelist_nodes instanceof Array)for(a=0;a<o.whitelist_nodes.length;a++)-1==n(o.whitelist_nodes[a],u.whitelist_nodes)&&u.whitelist_nodes.push(o.whitelist_nodes[a]);i.whitelist=o.whitelist?!0:!1,o.attr_whitelist&&(i.attr_whitelist=r(i.attr_whitelist,o.attr_whitelist)),i.node=o.node?o.node:i.node}return i}var u=this,c=u.dom.createDocumentFragment();u.current_element=c,u.whitelist_nodes=[];for(var s=0;s<e.childNodes.length;s++)a.call(this,e.childNodes[s]);return c.normalize&&c.normalize(),c},t.Config||(t.Config={}),t.Config.BASIC={elements:["a","b","blockquote","br","cite","code","dd","dl","dt","em","i","li","ol","p","pre","q","small","strike","strong","sub","sup","u","ul"],attributes:{a:["href"],blockquote:["cite"],q:["cite"]},add_attributes:{a:{rel:"nofollow"}},protocols:{a:{href:["ftp","http","https","mailto",t.RELATIVE]},blockquote:{cite:["http","https",t.RELATIVE]},q:{cite:["http","https",t.RELATIVE]}}},t.Config.RELAXED={elements:["a","b","blockquote","br","caption","cite","code","col","colgroup","dd","dl","dt","em","h1","h2","h3","h4","h5","h6","i","img","li","ol","p","pre","q","small","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","u","ul","div"],attributes:{a:["href","title"],blockquote:["cite"],col:["span","width"],colgroup:["span","width"],img:["align","alt","height","src","title","width"],ol:["start","type"],q:["cite"],table:["summary","width"],td:["abbr","axis","colspan","rowspan","width"],th:["abbr","axis","colspan","rowspan","scope","width"],ul:["type"],div:["class"]},protocols:{a:{href:["ftp","http","https","mailto",t.RELATIVE]},blockquote:{cite:["http","https",t.RELATIVE]},img:{src:["http","https",t.RELATIVE]},q:{cite:["http","https",t.RELATIVE]}}},t.Config.RESTRICTED={elements:["b","em","i","strong","u"]};var n=[new t({}),new t(t.Config.RESTRICTED),new t(t.Config.BASIC),new t(t.Config.RELAXED)];return function(t,r){var a=document.createElement("div"),o=document.createElement("div");return r=r>=0?r:3,a.innerHTML=e.toStr(t),o.appendChild(n[r].clean_node(a)),o.innerHTML}}])}();