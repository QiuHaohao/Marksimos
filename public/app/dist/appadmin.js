!function(){"use strict";angular.module("marksimosadmin",["pascalprecht.translate","notifications","marksimos.websitecomponent","marksimos.commoncomponent"]),angular.module("marksimosadmin").controller("adminLoginController",["$scope","$timeout","$http","$window",function(a,n,e,i){a.data={admin:{email:"",password:""}},a.login=function(n){n.$valid&&e.post("/marksimos/api/login",a.data.admin).success(function(){i.location.href="/marksimos/adminhome"}).error(function(a,e){400==e&&(console.log(a,e),n.password.$valid=!1,n.password.$invalid=!0)})}}]),angular.module("marksimosadmin").controller("adminHomeController",["$scope","$http","$notification",function(a,n,e){function i(a){var n={0:function(){return"A"},1:function(){return"B"},2:function(){return"C"},3:function(){return"D"},4:function(){return"E"},5:function(){return"F"}};return"function"!=typeof n[a]?!1:n[a]()}a.css={leftmenu:11,menuTabShow:[!1,!1,!1,!1,!1,!1],seminarId:0,runButtonDisabled:!1},a.data={currentUser:null,newDistributor:{username:"",email:"",password:"",phone:"",pincode:"",country:null,state:"shanghai",city:"shanghai",district:"",street:"",num_of_license_granted:0,gameType:""},searchDistributor:{username:"",email:"",user_status:"false"},distributors:[],newFacilitator:{username:"",email:"",password:"",phone:"",pincode:"",country:null,state:"shanghai",city:"shanghai",district:"",street:"",num_of_license_granted:0},searchFacilitator:{username:"",email:"",user_status:"false"},facilitators:[],newStudent:{username:"",email:"",password:"",phone:"",country:null,state:"shanghai",city:"shanghai",occupation:"",university:"",organization:"",firstname:"",lastname:""},searchStudent:{username:"",email:"",user_status:"false",user_ise4e:""},students:[],newSeminar:{description:"",country:null,state:"shanghai",city:"shanghai",venue:"",simulation_span:4,company_num:3},searchSeminar:{id:"",status:"false"},seminars:[],addStudentToSeminar:{seminar_id:0,student_id:"",company_id:0,email:""},country:[{id:"DZ2",name:"Algeria"},{id:"AI2",name:"Anguilla"},{id:"AG2",name:"Antigua"},{id:"AR2",name:"Argentina"},{id:"AU2",name:"Australia"},{id:"AT2",name:"Austria"},{id:"BS2",name:"Bahamas"},{id:"BH2",name:"Bahrain"},{id:"BB2",name:"Barbados"},{id:"BY2",name:"Belarus"},{id:"BE2",name:"Belgium"},{id:"BM2",name:"Bermuda"},{id:"BW2",name:"Botswana"},{id:"BR2",name:"Brazil"},{id:"VG2",name:"British Virgin Islands"},{id:"BN2",name:"Brunei"},{id:"BG2",name:"Bulgaria"},{id:"CA2",name:"Canada"},{id:"KY2",name:"Cayman Islands"},{id:"CL2",name:"Chile"},{id:"CN2",name:"China"},{id:"CO2",name:"Colombia"},{id:"HR2",name:"Croatia"},{id:"CY2",name:"Cyprus"},{id:"CZ2",name:"Czech Republic"},{id:"DK2",name:"Denmark"},{id:"DM2",name:"Dominica"},{id:"DO2",name:"Dominican Republic"},{id:"EG2",name:"Egypt"},{id:"SV2",name:"El Salvador"},{id:"EE2",name:"Estonia"},{id:"FI2",name:"Finland"},{id:"FR2",name:"France"},{id:"GY2",name:"French Guiana"},{id:"GE2",name:"Georgia"},{id:"DE2",name:"Germany"},{id:"GI2",name:"Gibraltar"},{id:"GR2",name:"Greece"},{id:"GD2",name:"Grenada"},{id:"GP2",name:"Guadeloupe"},{id:"GT2",name:"Guatemala"},{id:"HK2",name:"Hong Kong"},{id:"HU2",name:"Hungary"},{id:"IS2",name:"Iceland"},{id:"IN2",name:"India"},{id:"ID2",name:"Indonesia"},{id:"IR2",name:"Iran"},{id:"IE2",name:"Ireland"},{id:"IL2",name:"Israel"},{id:"IT2",name:"Italy"},{id:"JM2",name:"Jamaica"},{id:"JP2",name:"Japan"},{id:"JO2",name:"Jordan"},{id:"KZ2",name:"Kazakhstan"},{id:"KR2",name:"Korea, South"},{id:"KG2",name:"Kyrgyzstan"},{id:"LV2",name:"Latvia"},{id:"LT2",name:"Lithuania"},{id:"LU2",name:"Luxembourg"},{id:"MO2",name:"Macau"},{id:"MY2",name:"Malaysia"},{id:"MT2",name:"Malta"},{id:"MQ2",name:"Martinique"},{id:"MX2",name:"Mexico"},{id:"MD2",name:"Moldova"},{id:"MC2",name:"Monaco"},{id:"MS2",name:"Montserrat"},{id:"NL2",name:"Netherlands"},{id:"NZ2",name:"New Zealand"},{id:"NO2",name:"Norway"},{id:"OM2",name:"Oman"},{id:"PA2",name:"Panama"},{id:"PE2",name:"Peru"},{id:"PH2",name:"Philippines"},{id:"PL2",name:"Poland"},{id:"PT2",name:"Portugal"},{id:"PR2",name:"Puerto Rico"},{id:"QA2",name:"Qatar"},{id:"RE2",name:"Reunion"},{id:"RO2",name:"Romania"},{id:"RU2",name:"Russian Federation"},{id:"LC2",name:"Saint Lucia"},{id:"VC2",name:"Saint Vincent and the Grenadines"},{id:"SA2",name:"Saudi Arabia"},{id:"RS2",name:"Serbia"},{id:"SG2",name:"Singapore"},{id:"SK2",name:"Slovakia"},{id:"SI2",name:"Slovenia"},{id:"ZA2",name:"South Africa"},{id:"ES2",name:"Spain"},{id:"LK2",name:"Sri Lanka"},{id:"KN2",name:"St.Kitts and Nevis"},{id:"SE2",name:"Sweden"},{id:"CH2",name:"Switzerland"},{id:"TW2",name:"Taiwan"},{id:"TJ2",name:"Tajikistan"},{id:"TH2",name:"Thailand"},{id:"TT2",name:"Trinidad and Tobago"},{id:"TR2",name:"Turkey"},{id:"UA2",name:"Ukraine"},{id:"AE2",name:"United Arab Emirates"},{id:"UK2",name:"United Kingdom"},{id:"UI2",name:"Universal Toll Free"},{id:"UY2",name:"Uruguay"},{id:"US2",name:"USA"},{id:"VE2",name:"Venezuela"},{id:"VN2",name:"Vietnam"}]},a.data.newDistributor.country=a.data.country[20].name,a.data.newFacilitator.country=a.data.country[20].name,a.data.newStudent.country=a.data.country[20].name,a.data.newSeminar.country=a.data.country[20].name,a.adminInit=function(){n.get("/marksimos/api/admin/user").success(function(n){a.data.currentUser=n,1===a.data.currentUser.role?(a.getDistributorsInit(),a.getFacilitatorsInit(),a.getStudentsInit(),a.css.menuTabShow=[!1,!0,!0,!0,!0,!0,!0]):2===a.data.currentUser.role?(a.getFacilitatorsInit(),a.css.menuTabShow=[!1,!0,!1,!0,!1,!1,!1]):3===a.data.currentUser.role&&(a.getStudentsInit(),a.getSeminarInit(),a.css.menuTabShow=[!1,!0,!1,!1,!0,!0,!1])}).error(function(a){console.log(a)})},a.getDistributorsInit=function(){n.get("/marksimos/api/admin/distributors").success(function(n){a.data.distributors=n}).error(function(a){console.log(a)})},a.getFacilitatorsInit=function(){n.get("/marksimos/api/admin/facilitators").success(function(n){a.data.facilitators=n}).error(function(a){console.log(a)})},a.getStudentsInit=function(){n.get("/marksimos/api/admin/students").success(function(n){a.data.students=n}).error(function(a){console.log(a)})},a.getSeminarInit=function(){n.get("/marksimos/api/admin/facilitator/seminar").success(function(n){angular.forEach(n,function(a){a.companyMember=[],angular.forEach(a.companyAssignment,function(n,e){a.companyMember.push({name:i(e),students:n})})}),a.data.seminars=n}).error(function(a){console.log(a)})},a.adminInit(),a.searchDistributor=function(e){e.$valid&&n.get("/marksimos/api/admin/distributors",{params:a.data.searchDistributor}).success(function(n){a.data.distributors=n}).error(function(a){console.log(a)})},a.createNewDistributor=function(i){i.$valid&&(console.log(a.data.newDistributor),n.post("/marksimos/api/admin/distributors",a.data.newDistributor).success(function(){a.getDistributorsInit(),a.css.leftmenu=21,e.success("Save success","Create Distributor success")}).error(function(a){console.log(a),e.error("Save failed",a.message)}))},a.searchFacilitator=function(e){e.$valid&&n.get("/marksimos/api/admin/facilitators",{params:a.data.searchFacilitator}).success(function(n){a.data.facilitators=n}).error(function(a){console.log(a)})},a.createNewFacilitator=function(i){i.$valid&&(console.log(a.data.newFacilitator),n.post("/marksimos/api/admin/facilitators",a.data.newFacilitator).success(function(){a.getFacilitatorsInit(),a.css.leftmenu=31,e.success("Save success","Create Facilitator success")}).error(function(a){console.log(a),e.error("Save failed",a.message)}))},a.searchStudent=function(e){e.$valid&&n.get("/marksimos/api/admin/students",{params:a.data.searchStudent}).success(function(n){a.data.students=n}).error(function(a){console.log(a)})},a.resetPassword=function(i){var t={student_id:i};n.post("/marksimos/api/admin/resetPassword",t).success(function(){a.getStudentsInit(),a.css.leftmenu=41,e.success("Save success","Reset Student Password success")}).error(function(a){e.error("Save failed",a.message)})},a.createNewStudent=function(i){i.$valid&&n.post("/marksimos/api/admin/students",a.data.newStudent).success(function(){a.getStudentsInit(),a.css.leftmenu=41,e.success("Save success","Create Student success")}).error(function(a){e.error("Save failed",a.message)})},a.searchSeminar=function(e){e.$valid&&n.get("/marksimos/api/admin/facilitator/seminar",{params:a.data.searchSeminar}).success(function(n){a.data.seminars=n}).error(function(a){console.log(a)})},a.createNewSeminar=function(i){i.$valid&&(console.log(a.data.newSeminar),n.post("/marksimos/api/admin/seminar",a.data.newSeminar).success(function(){a.getSeminarInit(),a.css.leftmenu=51,e.success("Save success","Create Seminar success")}).error(function(a){console.log(a),e.error("Save failed",a.message)}))},a.chooseCompany=function(n,e){n.currentCompanyName=e.companyName,a.data.addStudentToSeminar.seminar_id=n.seminarId,a.data.addStudentToSeminar.company_id=e.companyId},a.addStudentToSeminar=function(i,t){0===a.data.addStudentToSeminar.company_id||angular.isUndefined(t)||""===t?a.css.seminarId=i:(a.css.seminarId=0,a.data.addStudentToSeminar.email=t,n.post("/marksimos/api/admin/assign_student_to_seminar",a.data.addStudentToSeminar).success(function(){a.getSeminarInit(),e.success("Save success","Add Student to Seminar success"),a.data.addStudentToSeminar.seminar_id=0,a.data.addStudentToSeminar.company_id=0,a.data.addStudentToSeminar.student_id=0}).error(function(a){console.log(a),e.error("Save failed",a.message)}))},a.initSeminar=function(i){a.css.runButtonDisabled=!0,n.post("/marksimos/api/admin/init",{seminar_id:i}).success(function(){a.getSeminarInit(),e.success("Save success","Init Seminar success"),a.css.runButtonDisabled=!1}).error(function(n){e.error("Save failed",n.message),a.css.runButtonDisabled=!1})},a.runSeminar=function(i,t){a.css.runButtonDisabled=!0,n.post("/marksimos/api/admin/runsimulation/"+i+"/"+t).success(function(){a.getSeminarInit(),e.success("Save success","Run Seminar success"),a.css.runButtonDisabled=!1}).error(function(n){e.error("Save failed",n.message),a.css.runButtonDisabled=!1})}}])}();